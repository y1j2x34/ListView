"use strict";!(function(){function ConstConfigure(a){this.value=a;this.writable=false;this.configurable=true;this.enumerable=true}function createConstructor(a,b){var c=new Function("init","return function "+b+"(){init.apply(this,arguments);}")(a);var d=a.toString();var e=d.indexOf("(");var f=d.indexOf(")");var g=d.substring(e,f+1);var toString="function "+b+g+"{init.apply(this,arguments);}";Object.defineProperties(c,{name:{value:b},toString:new ConstConfigure(function(){return toString})});return c}function forEachProp(a,b){Object.getOwnPropertyNames(a).forEach(b)}function _copy(c,d,e){var f={};if(e instanceof Array){for(var i=0;i<e.length;i++){f[e[i]]=true}}forEachProp(c,function(a){if(d.hasOwnProperty(a)){return}if(f[a]){return}var b=Object.getOwnPropertyDescriptor(c,a);Object.defineProperty(d,a,b)})}function _extendsStatics(c){var d=c.superclass;if(d==c)return;var e={"classname":true,"constructor":true};forEachProp(d,function(b){if(b in c||e[b]){return}Object.defineProperty(c,b,{get:function(){return d[b]},set:function(a){d[b]=a}})})}function _copyStatics(b,c){var d={"classname":true,"name":true,"constructor":true,"create":true,"prototype":true};forEachProp(c,function(a){if(d[a]){return}Object.defineProperty(b,a,{value:c[a],writable:true})})}function _newInstance(){var a=this;var b=Object.create(a.prototype);a.apply(b,arguments);return b}function Sup(){}Object.defineProperties(Sup,{create:new ConstConfigure(_newInstance),classname:new ConstConfigure("Sup"),constructor:new ConstConfigure(Sup)});Object.defineProperties(Sup.prototype,{superclass:new ConstConfigure(Sup),"const":new ConstConfigure(function(a,b){Object.defineProperty(this,a,new ConstConfigure(b))}),callSuper:new ConstConfigure(function(){var a=this.__proto__.__proto__;this.superclass.constructor.apply(a,arguments)})});var h={"Sup":Sup};function createClass(a){var b=a.name;var c=a.superclass;var d=a.init||function(){};var e=a.statics||{};var f=createConstructor(d,b);f.prototype=Object.create(c.prototype,{constructor:new ConstConfigure(f),superclass:new ConstConfigure(c),classname:new ConstConfigure(b),"class":new ConstConfigure(f)});Object.defineProperties(f,{superclass:new ConstConfigure(c),constructor:new ConstConfigure(f)});_extendsStatics(f);_copyStatics(f,e);_copy(a,f.prototype,["name","statics"]);return f}h.Error=createClass({name:"Error",superclass:Sup,init:Error});function _create(){var a=arguments;var b,def;if(a.length===1){var c=typeof a[0];switch(c){case"string":b=a[0];break;case"object":b=a[0].name;def=a[0];break;case"function":if(!a[0].name){throw h.Error.create("anonymous constructor ");}else{b=a[0].name;def={init:a[0]}}break;default:throw h.Error.create("invalid type :"+c);}}else if(a.length>=2){b=a[0];if(typeof a[1]==="function"){def={init:a[1]}}else{def=a[1]}}if(def===undefined){def={}}def.name=def.name||b;if(!def.superclass||!(def.superclass.prototype instanceof Sup)){def.superclass=h[def.superclass]||h.Sup}return createClass(def)}function _namespace(c){var d={namespace:!c?"":c+"."};return{of:function(a){return h[d.namespace+a]},create:function(){var a=_create.apply(d,arguments);if(!!d.namespace){h[d.namespace+a.name]=a}else{h[a.name]=a}return this},classes:function(){var a={};for(var b in h){if(b.indexOf(d.namespace)===0){a[b]=h[b]}}return a}}}window.FClass=_namespace("");window.FClass.namespace=_namespace})();(function(){function defaultCallback(a,b){return b||{}}FClass.namespace("com.vgerbot.utils").create("OPath",{init:function(a,b){this.root=a||{};this.sep=b||"."},get:function(a,b){if(typeof a!="string"){throw new Error("Illegal argument : "+a);}if(typeof b!=="function"){b=defaultCallback}var c=a.split(this.sep);var d=this.root;for(var i=0;i<c.length;i++){var e=c[i];var f=b.call(this,e,d[e],c,i);d[e]=f;d=f}return d}})})();(function(){var l=FClass.namespace("com.vgerbot.utils");function callObserver(a,b){if(a!==undefined&&a!==null){try{var c=[a];c.push.apply(c,b);a.callback.apply(a.source,c)}catch(e){console.error(e)}finally{a.times-=1}}}l.create("Observer",{init:function(a,b,c,d,e){this.callSuper();this.source=a;this.name=b;this.data=c;this.callback=d;this.times=e||Infinity}}).create("Subject",{init:function(){this.callSuper();this.observers={};this.$$opath=l.of("OPath").create(this.observers)},__attach:function(d,e,f,g){var h=this;if(d===undefined){d=undefined+""}var j=h.$$opath.get(d,function(a,b,c,i){if(i===c.length-1){return[]}else{return b||{}}});j.push(l.of("Observer").create(h,d,f,e,g));return this},on:function(a,b,c){var d;if('function'===typeof b){d=c;c=b}else if('function'===typeof c){d=b}return this.__attach(a,c,d)},one:function(a,b,c){var d;if('function'===typeof b){d=c;c=b}else if('function'===typeof c){d=b}return this.__attach(a,c,d,1)},trigger:function(c){var d=l.of("Observer");if(c===undefined){c=undefined+""}var e=this.$$opath.get(c,function(a,b){return b});if(e){var f=Array.prototype.slice.call(arguments,1);(function call(a){for(var k in a){var b=a[k];if(b instanceof d){callObserver.call(this,b,f)}else{call(b)}}})(e);return true}return false},off:function(d,e){var f=l.of("Observer");if(d===undefined){d=undefined+""}if(d==="*"){this.observers=this.$$opath.root={};return}var g=this.$$opath.get(d);if(typeof e!=="function"){this.$$opath.get(d,function(a,b,c,i){if(i===c.length-1){return{}}else{return b}})}else{(function loop(a){for(var i in a){var b=a[i];if((b instanceof f)&&b.callback===e){a[i]=undefined}else{loop(b)}}if(a instanceof Array){while(true){var i=a.indexOf(undefined);if(i==-1)break;a.splice(i,1)}}else{for(var c in a){if(a[c]===undefined){delete a[c]}}}})(g)}return this}})})();"use strict";(function(){var f=function(){var a=0;return function(){return a++}};var g=FClass.namespace("com.vgerbot.ui.explorer.model");g.create("Item",{init:function(a,b){this.id=a;this.select(false);this.data=b},select:function(a){this.selected=a}}).create("Explorer",{superclass:"com.vgerbot.utils.Subject",statics:{nextSeq:f(),SUPPORTED_SPECS:["xs","sm","md","lg"],SUPPORTED_THEMES:["grid","list"],SUPPORTED_CHECK_VALUES:["true","false","show","hide"],relc:function(a,b){if(!(a instanceof Array&&b instanceof Array)){return[]}if(a.length<1||b.length<1){return b}var c={};a.forEach(function(a,b){c[a]=b});var d=[];b.forEach(function(a){if(c[a]===undefined){d.push(a)}});return d}},init:function(){this.callSuper();this.items={};this.itemIds=[];this.id="exp-"+this.class.nextSeq();this.selects=[];this.itemSeq=f()},_isArray:function(a){return a instanceof Array},createItem:function(a){var b=g.of("Item").create(this.id+"-"+this.itemSeq(),a);this.items[b.id]=b;this.itemIds.push(b.id);this.trigger(this.id+".create",b);this.trigger("create",b)},deleteItem:function(b){var c=this;var d=[];b.forEach(function(a){if(c.items.hasOwnProperty(a)){d.push(c.items[a])}});c._deleteItems(d)},_deleteItems:function(d){var e=this;d.forEach(function(a){delete e.items[a.id];var b=e.itemIds.indexOf(a.id);e.itemIds.splice(b,1);var c=e.selects.indexOf(a.id);e.selects.splice(c,1);e.trigger(e.id+".removeItem",a);e.trigger("removeItem",a)});e.trigger(this.id+".remove",d);e.trigger("remove",d)},update:function(b){var c=this;if(b.data instanceof Array){var d=[];for(var e in c.items){d.push(c.items[e])}c._deleteItems(d);b.data.forEach(function(a){c.createItem(a)})}if(b.theme&&c.class.SUPPORTED_THEMES.indexOf(b.theme)!==-1){c.trigger(this.id+".updateTheme",b.theme);c.trigger("updateTheme",b.theme)}if(b.spec&&c.class.SUPPORTED_SPECS.indexOf(b.spec)!==-1){c.trigger(this.id+".updateSpec",b.spec);c.trigger("updateSpec",b.spec)}if(c.class.SUPPORTED_CHECK_VALUES.indexOf(b.check+"")!==-1){c.trigger(this.id+".updateCheck",b.check);c.trigger("updateCheck",b.check)}},select:function(){var c=this,ids=Array.prototype.slice.call(arguments);var d=this.selects.slice();var e={};this.selects.forEach(function(a,b){e[a]=b});ids.forEach(function(a){c.items[a].select(true);var b=e[a];if(b===undefined){c.selects.push(a)}});this.trigger(this.id+".select",this.selects,d);this.trigger("select",this.selects,d)},unselect:function(){var c=this,ids=Array.prototype.slice.call(arguments);var d=c.selects.slice();ids.forEach(function(a){var b=c.selects.indexOf(a);if(b>-1){c.selects.splice(b,1);c.items[a].select(false)}});c.trigger(this.id+".select",c.selects,d);c.trigger("select",c.selects,d)},selectAll:function(){this.select.apply(this,this.itemIds)},unselectAll:function(){this.unselect.apply(this,this.selects)},getItems:function(c){if(this._isArray(c)){return}var d=[];var e=this;c.forEach(function(a){var b=e.items[a];if(b!==undefined){d.push(b)}});return d},off:function(a){if(a==="*")return false;if(typeof a==="string"){var b=a.split(".");if(b[1]==="ui"){return false}}var c=this.__proto__.__proto__;return c.off.apply(this,arguments)}})})();"use strict";(function($){var x=FClass.namespace("com.vgerbot.ui.explorer.model");var y=FClass.namespace("com.vgerbot.utils");var z="explorer";var A="explorer-item-data";var B=function(a,b){a.off(a.id);b.removeData(z);b.find(".explorer").remove();$(document).off("keydown."+a.id).off("keyup."+a.id)};var C=function(){return["<ul class='explorer-item-details' title='${cfg.name}'>","<li class='item-check'><input type='checkbox'></li>","<li class='item-icon ${cfg.icon}'></li>","<li class='item-name'>${cfg.name}</li>","</ul>"].join("")};var D=function(b,c){var d=y.of("OPath").create(b.data,".");return c.replace(/\$\{([^\}]+)\}/g,function(r,a){return d.get(a)})};var E=function(q,r){var s=$("<div>");var t=$("<ul>");s.addClass("explorer").addClass("explorer-"+q.theme).addClass("explorer-"+q.spec);if(q.check+""==="false"||q.check+""==="hide"){s.addClass("hide-check")}t.addClass("explorer-item-list");s.append(t);var u=x.of("Explorer").create();u.on(u.id+".remove",function(e,b){var c=[];b.forEach(function(a){c.push(a.id)});$(v(c)).remove()});var v=function(c){var d=[];c.forEach(function(a){var b=document.getElementById(a);if(b!==undefined){d.push(b)}});return d};u.on(u.id+".select",function(e,c,d){var f=this.class.relc(d,c),unselects=this.class.relc(c,d);if(unselects.length>0){var g=v(unselects);$(g).removeClass("active").each(function(a,b){$(b).find(".item-check>input[type=checkbox]").removeAttr("checked").removeProp("checked")})}if(f.length>0){var g=v(f);$(g).addClass("active").each(function(a,b){$(b).find(".item-check>input[type=checkbox]").attr("checked","checked").prop("checked","checked")})}});u.on(u.id+".create",function(e,a){var b=$("<li>");b.attr({id:a.id}).addClass("explorer-item");var c;switch(typeof q.template){case"string":c=q.template;break;case"function":c=q.template(a);break;default:c=C()}b.append(D(a,c));b.data(A,a);t.append(b)});u.on(u.id+".updateTheme",function(e,a){s.removeClass("explorer-grid").removeClass("explorer-list").addClass("explorer-"+a);q.theme=a});u.on(u.id+".updateSpec",function(e,b){var c=["xs","sm","md","lg"];c.forEach(function(a){s.removeClass("explorer-"+a)});s.addClass("explorer-"+b);q.spec=b});u.on(u.id+".updateCheck",function(e,a){switch(a+""){case"true":case"show":s.removeClass("hide-check");break;case"false":case"hide":s.addClass("hide-check");break}q.check=a});s.on("click",function(e){var a=$(e.target);if(s.prop("dragged")){s.removeProp("dragged");return}if((a.is(s)||a.is(t))&&!e.ctrlKey&&!e.shiftKey){u.unselectAll()}});s.on("click",".explorer-item",function(e){var c=$(e.currentTarget);var d=c.data(A);var f=c.index();if(e.shiftKey){var g=s.find(".explorer-item");var h=u.shiftSelectIndex;if(h===undefined){if(u.selects.length>0){h=s.find("#"+u.selects[u.selects.length-1]).index()}else{h=0}u.shiftSelectIndex=h}var i=[];var j=Math.min(h,f),maxIndex=Math.max(h,f);g.slice(j,maxIndex+1).each(function(a,b){i.push($(b).data(A).id)});var k=u.selects.filter(function(a){var b=$("#"+a).index();return b<j||b>maxIndex});u.unselect.apply(u,k);u.select.apply(u,i)}else if(e.ctrlKey){if(d.selected){u.unselect(d.id)}else{u.select(d.id);u.shiftSelectIndex=f}}else{if(d.selected&&u.selects.length<2){u.unselectAll()}else{u.unselectAll();u.select(d.id);u.shiftSelectIndex=f}}e.stopPropagation()});s.on("dblclick",".item-name",function(e){var a=$(e.currentTarget);var b=a.closest(".explorer-item").data(A);a.attr("contenteditable","").text(b.data.cfg.name).focus()});s.on("mousedown",".item-name[contenteditable]",function(e){e.stopPropagation()});s.on("keyup",".item-name",function(e){var a=$(e.currentTarget);if(e.ctrlKey){a.removeAttr("contenteditable");var b=a.closest(".explorer-item").data(A);b.data.cfg.name=a.text().trim();a.closest(".explorer-item-details").attr("title",a.text().trim());u.trigger("submit",b,"name");e.preventDefault();e.stopPropagation()}});s.on("focusout",".item-name",function(e){var a=$(e.currentTarget);if(a.attr("contenteditable")===undefined){return}a.removeAttr("contenteditable");var b=a.closest(".explorer-item").data(A);a.text(b.data.cfg.name)});var w=false,ctrlKeyDown=false;$(document).on("keydown."+u.id,function(e){w=e.shiftKey;ctrlKeyDown=e.ctrlKey;if(e.keyCode===65&&e.ctrlKey){u.selectAll();e.stopPropagation();e.preventDefault()}});$(document).on("keyup."+u.id,function(e){if(e.keyCode===17){ctrlKeyDown=false}if(e.keyCode===16){w=false}});s.on("dragSelect",function(e,i){if(i.width<20&&i.height<20){return}var j=i.top+i.height;s.prop("dragged",true);function collision(a,b){if(a.left>=b.left&&a.left>=b.left+b.width){return false}else if(a.left<=b.left&&a.left+a.width<=b.left){return false}else if(a.top>=b.top&&a.top>=b.top+b.height){return false}else if(a.top<=b.top&&a.top+a.height<=b.top){return false}return true}var k=[];var l=[];var m=s.offset();var n=s.find(".explorer-item");var o=n.height();var p=n.width();n.each(function(a,b){var c=$(b);var d=c.data(A);var e=c.offset();var f=e.top-m.top;if(f>j){if(!w&&!ctrlKeyDown){l.push.apply(l,u.itemIds.slice(a))}return false}var g=f+o;if(g<i.top){if(!w&&!ctrlKeyDown){if(d.selected){l.push(d.id)}}return}var h={left:e.left-m.left,top:f,width:p,height:o};if(collision(i,h)){if(!d.selected){k.push(d.id)}}else if(!w&&!ctrlKeyDown){if(d.selected){l.push(d.id)}}});u.unselect.apply(u,l);u.select.apply(u,k)});s.dragSelector();r.empty().append(s);if(q.data instanceof Array){u.update({data:q.data})}return u};$.fn.explorer=function(e){if(e===undefined||e===null){return}if(e===false){return this.each(function(a,b){var c=$(b);var d=c.data(z);if(d instanceof x.of("Explorer")){B(d,c)}})}e=$.extend({theme:"grid",spec:"md",template:C,data:[],check:"hide"},e);return this.each(function(a,b){var c=$(b);var d=c.data(z);if(d instanceof x.of("Explorer")){return}d=E(e,c);c.data(z,d)})};$.fn.dragSelector=function(){return this.each(function(h,i){var j=$(i);var k=$("<div>");k.addClass("drag-selector");k.appendTo(j);function mousePosition(e){var a=$(e.target);var b,my;if(a.is(j)){b=e.offsetX;my=e.offsetY}else{var c=a.offset();var d=j.offset();b=c.left-d.left+e.offsetX;my=c.top-d.top+e.offsetY}return{left:b,top:my}}var l=function(f,g){return function l(e){k.addClass("show");var a=mousePosition(e);var b=a.left,my=a.top;var c=Math.min(b,f),selw=Math.abs(f-b),sely=Math.min(my,g),selh=Math.abs(g-my);var d={left:c,top:sely,width:selw,height:selh};k.css(d);j.trigger("dragSelect",d)}};var m="mousemove."+Math.random();j.on("mousedown",function(e){if(e.button!==0){return}k.css({width:0,height:0});var a=mousePosition(e);j.on(m,l(a.left,a.top))});$(document).on("mouseup",function(e){if(e.button!==0){return}k.removeClass("show");j.off(m)})})}})(jQuery);